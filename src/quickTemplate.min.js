module.exports=function(e,n,t){function r(){var e=a.readFileSync(n,"utf8");o(e)}function o(n){c=n,c=function t(){return c=c.replace(new RegExp("\\|.*"+p),function(e){return e.substr(e.indexOf(p))}),c.match(new RegExp("\\|.*"+p))&&t(),c}().replace(new RegExp(f+"\\s+","g"),f).replace(new RegExp("\\s+"+p,"g"),p),s(e)}function s(e,n,t){void 0===t&&void 0===n&&(t=[],n=0,i=0);for(keys in e)if(e.hasOwnProperty(keys)){if("object"!=typeof e[keys]||e[keys]instanceof Array){var r=n?(n?t.join("."):"")+"."+keys:keys,o=new RegExp(f+r+p,"g");c=c.replace(o,e[keys])}else t[n]=keys,s(e[keys],n+1,t);t.splice(n,Object.keys(e).length-n),0===n&&(i+=1)}}var i,c,a=require("fs"),f="\\${",p="}";return t&&(f=t.tokenLeft||f,p=t.tokenRight||p),"object"!=typeof e?"Quicktemplate object parameter is not an object":(t&&t.string?o(n):r(),c)};